<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<link href="../css/bootstrap.min.css" rel="stylesheet" />
		<link href="../css/font-awesome.min.css" rel="stylesheet" />
		<link href="css/kxd.css" rel="stylesheet" />
		<link href="css/admin.css" rel="stylesheet" />
		<link href="../css/top.css" rel="stylesheet" />
	</head>
	<body>
		<div class="warpper">
			<div class="header">
			</div>
			<div class="sidebar">
				<nav>
					<div id="navbar">
						<ul class="sidebar-items nav">
							<a href="#user"><li>用户管理<div class="choose"></div></li></a>
							<a href="#role"><li>角色管理<div class="choose"></div></li></a>
							<a href="#permit"><li>角色管理<div class="choose"></div></li></a>
						</ul>
					</div>
				</nav>
			</div>
			<div class="tool-wrapper">
			</div>
			<script type="text/template" id="user-admin-temp">
				<div class="tool tool-big" id="user-admin">
					<div class="tool-header">
						<span>用户管理</span>
						<div class='add-user'>添加用户</div>
					</div>
					<div class="tool-content">
						<table class="table table-bordered">
							<thead>
								<tr>
									<th>#</th><th>用户名</th><th>修改</th><th>删除</th>
								</tr>
							</thead>
							<tbody class="user-admin-tbody">
								<%_.each(userList,function (model){%>
									<tr uid="<%=model.get('id')%>">
										<td><%=model.get('id')%></td>
										<td><%=model.get('username')%></td>
										<!--<td>
											<%_.each(model.get('roleList'),function (role) {%>
												<a href="javascript:void(0)" class="badge badge-choose" roleid="<%=role.id%>"><%=role.name%></a>
											<%})%>
											<a href="javascript:void(0)" class="edit-role">修改角色</a>
										</td>-->
										<td class="edit-user-button"><a href="javascript:void(0)" class="edit-user">修改密码</a></td>
										<td class="delete-user-button"><a href="javascript:void(0)" class="delete-user">删除</a></td>
									</tr>
								<%})%>
							</tbody>
						</table>
						<form class="form-horizontal edit-user-form">
						</form>
					</div>
				</div>
			</script>
			<script type="text/template" id="edit-user-temp">
				<div class="form-group">
			    	<label class="col-sm-2 control-label">用户名</label>
			    	<div class="col-sm-10">
			      		<input class="form-control" type="text" name="username" value="<%=user.username%>">
			    	</div>
			  	</div>
			  	<div class="form-group">
			    	<label class="col-sm-2 control-label" >新密码</label>
			    	<div class="col-sm-10">
			      	<input class="form-control" type="password" name="password">
			    	</div>
			  	</div>
			  	<div class="form-group">
			    	<label class="col-sm-2 control-label">确认密码</label>
			    	<div class="col-sm-10">
			      	<input class="form-control" type="password" name="confirmpwd">
			    	</div>
			  	</div>
			  	<div class="form-group">
			    	<div class="buttonlist">
			    		<div class="control-botton control-botton-2 cancel-submit">取消</div>
			    		<div class="control-botton control-botton-2" id="edit-submit">提交</div>
			    	</div>
			    </div>
			</script>
						<script type="text/template" id="role-check-list">
							<%_.each(roleList,function (role){%>
      							<div class="checkbox">
	        						<label><input type="checkbox" roleid="<%=role.get('id')%>" value="<%=role.get('name')%>"> <%=role.get('name')%></label>
      							</div>
							<%})%>
						</script>
			<script type="text/template" id="role-admin-temp">
 				<div class="tool tool-big" id="role-admin">
					<div class="tool-header">
						<span>角色管理</span>
					</div>
					<div class="tool-content">
						<table class="table table-bordered">
							<thead>
								<tr>
									<th>角色名称</th>
									<th>编码</th>
									<%typeList.each(function (type) {%>
										<th><%=type.get('name')%></th>
									<%})%>
									<th>修改</th><th>删除</th>
								</tr>
							</thead>
							<tbody class="role-admin-tbody">
								<%roleList.each(function (role) {%>
									<tr rid="<%=role.get('id')%>">
										<td><%=role.get('name')%></td>
										<td><%=role.get('code')%></td>
										<%var set={}%>
										<%_.each(role.get('operations'),function (op) {%>
											<%set[op.operation]=op%>
										<%})%>
										<%typeList.each(function (type) {%>
											<td>
												<%_.each(type.get('operations'),function (op) {%>
													<%if(set[op.id]){%>
														<a class="badge badge-exist" oid="<%=set[op.id].id%>" operation="<%=op.id%>">
															<span><%=op.name%></span>
															<i class="badge-remove icon-remove-sign op-remove"></i>
														</a>
													<%}else{%>
														<a class="badge" operation="<%=op.id%>">
															<span><%=op.name%></span>
															<i class="badge-remove icon-plus-sign op-add"></i>
														</a>
													<%}%>
												<%})%>
											</td>
										<%})%>
										<td class="edit-role-button"><a href="javascript:void(0)" class="edit-role">修改</a></td>
										<td class="delete-role-button"><a href="javascript:void(0)" class="delete-role">删除</a></td>
									</tr>
								<%})%>
							</tbody>
						</table>
						<div class="control-botton control-botton-2" id="add-new-role"><i class="icon-plus-sign"></i>添加新角色</div>
						<form class="form-horizontal role-admin-form">
						  	<div class="form-group">
						    	<label class="col-sm-2 control-label">角色名称</label>
						    	<div class="col-sm-10 rolename">
						    		<input class="form-control" name='name'>
						    	</div>
						  	</div>
						  	<div class="form-group">
						    	<label class="col-sm-2 control-label">角色编码</label>
						    	<div class="col-sm-10 code">
						    		<input class="form-control" name='code'>
						    	</div>
						  	</div>
						  	<div class="form-group">
						    	<div class="buttonlist">
						    		<div class="control-botton control-botton-2 cancel-submit">取消</div>
						    		<div class="control-botton control-botton-2" id="permission-submit">确定</div>
						    	</div>
						    </div>
						</form>
					</div>
				</div>
			</script>
			<script type="text/template" id="permit-admin-temp">
 				<div class="tool tool-big" id="permit-admin">
					<div class="tool-header">
						<span>权限管理</span>
					</div>
					<div class="tool-content">
						<table class="table table-bordered">
							<thead>
								<tr>
									<th>用户名</th>
									<th>单位</th>
									<th>角色</th>
									<th>删除</th>
								</tr>
							</thead>
							<tbody class="role-admin-tbody">
								<%permitList.each(function (permit) {%>
									<tr>
										<td><%=permit.get('username')%></td>
										<td><%=permit.get('unitname')%></td>
										<td><%=permit.get('rolename')%></td>
										<td><a>删除</a></td>
									</tr>
								<%})%>
							</tbody>
						</table>
					</div>
				</div>
			</script>

			<script type="text/template" id="module-list-temp">
  				<% for(var key in map){%>
					<li>
	  					<a href="javascript:void(0)" class="module-name"><%=key%> <i class="icon-double-angle-down"></i></a>
  						<div class="checkbox">
  						<table class="table table-bordered">
  						<%_.each(map[key],function (resource) {%>
	  						<tr resourceid='<%=resource.id%>'>
	 							<td class="permission-name"><label><%=resource.name%></label></td>
		    					<td><label><input type="checkbox"><i></i> Create</label></td>
		    					<td><label><input type="checkbox"><i></i> Read</label></td>
		    					<td><label><input type="checkbox"><i></i> Update</label></td>
		    					<td><label><input type="checkbox"><i></i> Delete</label></td>
							</tr>
						<%})%>
						</table>
						  						</div>
						  					</li>
						  				<%}%>
						  			</script>
		</div>
		<script type="text/javascript" src="require.js" data-main="app.js"></script>
	</body>
</html>